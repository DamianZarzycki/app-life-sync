<div class="registration-form-wrapper">
  <div class="registration-header">
    <h1 class="text-3xl font-bold mb-2 text-primary">Create Account</h1>
    <p class="text-gray-600 mb-6 text-sm">
      Join LifeSync and start your reflection journey
    </p>
  </div>

  <!-- Error Alert -->
  @if (error()) {
    <app-form-error-alert
      [error]="error()"
      (onDismiss)="dismissError()"
    ></app-form-error-alert>
  }

  <!-- Form -->
  <form [formGroup]="formGroup" (ngSubmit)="submit()" class="space-y-4">
    <!-- Email Field -->
    <div class="form-group mb-4">
      <label class="block text-sm font-medium text-gray-700 mb-2" [ngClass]="{ 'text-red-600': hasEmailError() }">
        Email Address <span class="text-red-500">*</span>
      </label>
      <input
        formControlName="email"
        type="email"
        placeholder="your@email.com"
        (blur)="onEmailBlur()"
        class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition"
        [ngClass]="{ 'border-red-500 ring-1 ring-red-500': hasEmailError(), 'border-gray-300': !hasEmailError() }"
      />
      @if (hasEmailError()) {
        <p class="text-red-500 text-sm mt-1">{{ getEmailErrorMessage() }}</p>
      }
    </div>

    <!-- Password Field -->
    <div class="form-group">
      <label class="block text-sm font-medium text-gray-700 mb-2" [ngClass]="{ 'text-red-600': hasPasswordError() }">
        Password <span class="text-red-500">*</span>
      </label>
      <div class="relative">
        <input
          formControlName="password"
          [type]="showPassword() ? 'text' : 'password'"
          placeholder="Enter password"
          (blur)="onPasswordBlur()"
          class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition"
          [ngClass]="{ 'border-red-500 ring-1 ring-red-500': hasPasswordError(), 'border-gray-300': !hasPasswordError() }"
        />
        <button
          type="button"
          (click)="showPassword.set(!showPassword())"
          class="absolute right-3 top-2 text-gray-500 hover:text-gray-700 transition"
        >
          <i
            nz-icon
            [nzType]="showPassword() ? 'eye' : 'eye-invisible'"
            nzTheme="outline"
          ></i>
        </button>
      </div>
      @if (hasPasswordError()) {
        <p class="text-red-500 text-sm mt-1">{{ getPasswordErrorMessage() }}</p>
      }
    </div>

    <!-- Password Strength Indicator -->
    @if (getPasswordValue()) {
      <app-password-strength-indicator
        [password]="getPasswordValue()"
        [showDetails]="true"
      ></app-password-strength-indicator>
    }

    <!-- Confirm Password Field -->
    <div class="form-group">
      <label class="block text-sm font-medium text-gray-700 mb-2" [ngClass]="{ 'text-red-600': hasConfirmPasswordError() }">
        Confirm Password <span class="text-red-500">*</span>
      </label>
      <div class="relative">
        <input
          formControlName="confirmPassword"
          [type]="showConfirmPassword() ? 'text' : 'password'"
          placeholder="Confirm password"
          (blur)="onConfirmPasswordBlur()"
          class="w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 transition"
          [ngClass]="{ 'border-red-500 ring-1 ring-red-500': hasConfirmPasswordError(), 'border-gray-300': !hasConfirmPasswordError() }"
        />
        <button
          type="button"
          (click)="showConfirmPassword.set(!showConfirmPassword())"
          class="absolute right-3 top-2 text-gray-500 hover:text-gray-700 transition"
        >
          <i
            nz-icon
            [nzType]="showConfirmPassword() ? 'eye' : 'eye-invisible'"
            nzTheme="outline"
          ></i>
        </button>
      </div>
      @if (hasConfirmPasswordError()) {
        <p class="text-red-500 text-sm mt-1">{{ getConfirmPasswordErrorMessage() }}</p>
      }
    </div>

    <!-- Sign Up Button -->
    <button
      type="submit"
      [disabled]="!isFormValid()"
      class="w-full mt-6 px-4 py-2 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition"
    >
      @if (!isLoading()) {
        <span>Create Account</span>
      } @else {
        <span class="flex items-center justify-center space-x-2">
          <nz-spin nzSimple [nzSize]="'small'"></nz-spin>
          <span>Creating...</span>
        </span>
      }
    </button>
  </form>
</div>
